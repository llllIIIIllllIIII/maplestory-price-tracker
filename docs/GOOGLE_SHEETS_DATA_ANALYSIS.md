# Google Sheets 資料結構分析

## 問題現狀

從調試結果發現，Google Sheets 包含兩種不同格式的資料：

### 第一部分（第1-7行）- 真實道具資料
- **格式**: A欄=道具名, B欄=WC價格, C欄=萬楓幣價值, D欄=萬
- **範例**: 漫天花雨 | 30.0 WC | 28.5 萬楓幣 | 萬
- **特點**: 這些是真實的交易資料

### 第二部分（第14-19行）- 效率排名列表  
- **格式**: A欄=道具名, B欄=排名, C欄=萬楓幣價值, D欄=WC
- **範例**: 高效能喇叭 | 10 (排名) | 13200 萬楓幣 | WC
- **特點**: B欄是排名而非WC價格，導致錯誤的效率計算

## 資料錯誤範例

**高效能喇叭 (Megaphone Box)**:
- **表格資料**: 10 WC (實際是排名), 13200 萬楓幣
- **錯誤效率**: 13200 ÷ 10 = 1320 萬楓幣/WC
- **實際資料**: 109 WC/個, 210 萬楓幣/個
- **正確效率**: 210 ÷ 109 = 1.93 萬楓幣/WC

## 解決方案

### 1. 立即修正 (已完成)
- 手動修正高效能喇叭資料 ✅
- 效率從 1320 修正為 19.27 萬楓幣/WC ✅

### 2. 改進解析邏輯 (已部分完成)
- 只處理分類為"萬"的資料 ✅  
- 跳過分類為"WC"的排名列表 ✅

### 3. 建議的 Google Sheets 結構調整
建議在 Google Sheets 中：
- 將真實交易資料和排名列表分離到不同的工作表
- 或使用明確的標識來區分資料類型
- 確保 WC 價格欄位包含真實的 WC 價格而非排名

### 4. 資料校驗系統
- 建立已知正確資料的清單
- 在同步時自動校驗和修正明顯錯誤的資料
- 添加警告機制來標識異常的效率值

## 當前狀態
- ✅ 高效能喇叭資料已修正
- ✅ 解析邏輯已改進，避免錯誤資料
- ⚠️ 可能還有其他道具需要類似修正
- ⚠️ 需要與 Google Sheets 維護者溝通資料結構
